import requests
from colorama import Fore, Style, init
from datetime import datetime

init(autoreset=True)

# ---------------- CONFIG ---------------- #
COMMON_PATHS = [
    "admin", "login", "dashboard", "config", "backup",
    ".env", ".git", "phpinfo.php", "robots.txt"
]

SECURITY_HEADERS = [
    "Content-Security-Policy",
    "X-Frame-Options",
    "X-Content-Type-Options",
    "Strict-Transport-Security",
    "Referrer-Policy"
]

OUTPUT_FILE = "vulnerability_report.txt"
TIMEOUT = 5
# ---------------------------------------- #

def banner():
    print(Fore.CYAN + """
██╗   ██╗██╗   ██╗██╗     ███╗   ██╗███████╗██████╗ 
██║   ██║██║   ██║██║     ████╗  ██║██╔════╝██╔══██╗
██║   ██║██║   ██║██║     ██╔██╗ ██║█████╗  ██████╔╝
╚██╗ ██╔╝██║   ██║██║     ██║╚██╗██║██╔══╝  ██╔══██╗
 ╚████╔╝ ╚██████╔╝███████╗██║ ╚████║███████╗██║  ██║
  ╚═══╝   ╚═════╝ ╚══════╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝
    """ + Style.RESET_ALL)

def scan_headers(url):
    print(Fore.CYAN + "\n[+] Scanning Security Headers...\n")
    findings = []

    try:
        response = requests.get(url, timeout=TIMEOUT)
        headers = response.headers

        for header in SECURITY_HEADERS:
            if header not in headers:
                print(Fore.RED + f"[!] Missing Header: {header}")
                findings.append(f"Missing Header: {header}")
            else:
                print(Fore.GREEN + f"[✓] Header Present: {header}")

        server = headers.get("Server", "Unknown")
        print(Fore.YELLOW + f"\n[•] Server Disclosure: {server}")
        findings.append(f"Server Disclosure: {server}")

    except Exception as e:
        print(Fore.RED + f"[!] Error scanning headers: {e}")

    return findings

def scan_directories(url):
    print(Fore.CYAN + "\n[+] Scanning Common Directories...\n")
    findings = []

    for path in COMMON_PATHS:
        full_url = f"{url}/{path}"
        try:
            response = requests.get(full_url, timeout=TIMEOUT)
            if response.status_code in [200, 301, 302, 403]:
                print(Fore.RED + f"[!] Found: {full_url} ({response.status_code})")
                findings.append(f"Exposed Path: {full_url} ({response.status_code})")
        except:
            pass

    return findings

def save_report(url, findings):
    with open(OUTPUT_FILE, "w") as file:
        file.write("=== VULNERABILITY SCAN REPORT ===\n")
        file.write(f"Target: {url}\n")
        file.write(f"Scan Time: {datetime.now()}\n\n")

        if findings:
            for item in findings:
                file.write(item + "\n")
        else:
            file.write("No vulnerabilities detected.\n")

def main():
    banner()
    url = input(Fore.YELLOW + "Enter target URL (https://example.com): ").rstrip("/")

    all_findings = []

    all_findings.extend(scan_headers(url))
    all_findings.extend(scan_directories(url))

    save_report(url, all_findings)

    print(Fore.CYAN + f"\n[✔] Scan completed")
    print(Fore.CYAN + f"[✔] Report saved to {OUTPUT_FILE}")

if __name__ == "__main__":
    main()